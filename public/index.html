<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capture Basel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://unpkg.com/ml5@1/dist/ml5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Left Sidebar -->
    <aside class="sidebar">
        <!-- Title -->
        <div class="app-title">
            <img src="title_logo.jpg" alt="Basel Simplified" class="title-logo" />
        </div>

        <!-- Mode Switch -->
        <div class="section mode-switch-section">
            <div class="mode-switch-container">
                <button class="mode-switch-btn" data-mode="scene">Scene Mode</button>
                <button class="mode-switch-btn active" data-mode="grid">Grid Mode</button>
            </div>
        </div>

        <!-- Upload Section -->
        <div class="section upload-section">
            <label for="image-upload" class="upload-preview-combined">
                <input type="file" id="image-upload" accept="image/*" hidden />
                <img id="upload-preview" class="upload-preview" src="addimg.jpg" alt="Add Image" />
            </label>
        </div>

        <!-- Generate Button -->
        <div style="display: flex; gap: 8px;">
            <img id="generate-btn" class="generate-btn" src="gen-button.jpg" style="flex: 1; cursor: pointer;" />
        </div>

        <!-- Progress Section -->
        <div id="progress-container" class="section progress-section hidden">
            <div style="display: flex; align-items: center; gap: 8px;">
                <div class="progress-bar" style="flex: 1;">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <button id="cancel-btn" class="cancel-btn">×</button>
            </div>
            <div id="progress-text" class="progress-text">Generating...</div>
            <div id="status-updates" class="status-updates"></div>
        </div>

        <!-- Quartiere Section -->
        <div class="section quartiere-section">
            <div id="quartiere-grid" class="quartiere-grid">
                <button class="quartier-toggle" data-quartier="1">
                    <span class="quartier-name">Altstadt Grossbasel</span>
                    <span class="quartier-count" data-count="1">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="2">
                    <span class="quartier-name">Altstadt Kleinbasel</span>
                    <span class="quartier-count" data-count="2">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="3">
                    <span class="quartier-name">Vorstädte</span>
                    <span class="quartier-count" data-count="3">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="4">
                    <span class="quartier-name">Am Ring</span>
                    <span class="quartier-count" data-count="4">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="5">
                    <span class="quartier-name">Breite</span>
                    <span class="quartier-count" data-count="5">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="6">
                    <span class="quartier-name">Gundeldingen</span>
                    <span class="quartier-count" data-count="6">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="7">
                    <span class="quartier-name">St. Johann</span>
                    <span class="quartier-count" data-count="7">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="8">
                    <span class="quartier-name">St. Alban</span>
                    <span class="quartier-count" data-count="8">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="9">
                    <span class="quartier-name">Iselin</span>
                    <span class="quartier-count" data-count="9">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="10">
                    <span class="quartier-name">Bruderholz</span>
                    <span class="quartier-count" data-count="10">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="11">
                    <span class="quartier-name">Bachletten</span>
                    <span class="quartier-count" data-count="11">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="12">
                    <span class="quartier-name">Gotthelf</span>
                    <span class="quartier-count" data-count="12">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="13">
                    <span class="quartier-name">Clara</span>
                    <span class="quartier-count" data-count="13">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="14">
                    <span class="quartier-name">Wettstein</span>
                    <span class="quartier-count" data-count="14">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="15">
                    <span class="quartier-name">Hirzbrunnen</span>
                    <span class="quartier-count" data-count="15">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="16">
                    <span class="quartier-name">Rosental</span>
                    <span class="quartier-count" data-count="16">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="17">
                    <span class="quartier-name">Matthäus</span>
                    <span class="quartier-count" data-count="17">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="18">
                    <span class="quartier-name">Klybeck</span>
                    <span class="quartier-count" data-count="18">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="19">
                    <span class="quartier-name">Kleinhüningen</span>
                    <span class="quartier-count" data-count="19">0</span>
                </button>
                <button class="quartier-toggle" data-quartier="20">
                    <span class="quartier-name">Unknown</span>
                    <span class="quartier-count" data-count="20">0</span>
                </button>
            </div>
        </div>

        <!-- Info Button -->
        <button id="info-btn" class="info-btn" aria-label="Project Information">i</button>
    </aside>

    <!-- Main Canvas Area -->
    <main class="main-canvas">
        <div id="result-container" class="result-container">
            <div class="placeholder">Generated images will appear here</div>
        </div>
    </main>

    <!-- Grid Container -->
    <div id="grid-container" class="grid-container"></div>

    <!-- Hand Tracking Camera -->
    <div id="p5-container"></div>

    <!-- Scene Control Buttons -->
    <div id="scene-controls" class="scene-controls">
        <button id="random-images-btn" class="scene-control-btn" title="Add 6 Random Images">Random 6</button>
        <button id="normalize-size-btn" class="scene-control-btn" title="Make All Same Size">Same Size</button>
    </div>

    <!-- Info Modal -->
    <div id="info-modal" class="info-modal hidden">
        <div class="info-modal-content">
            <button id="info-close-btn" class="info-close-btn">&times;</button>
            <h2>Über dieses Projekt</h2>
            <div class="info-section">
                <h3>Team</h3>
                <p>Entwickelt von <strong>Oliver Wick</strong> und <strong>Nicolas Birrer</strong><br>
                unter dem Mentorat von <strong>Paulina Zybinska</strong></p>
                <p>Hochschule für Kunst und Gestaltung Basel FHNW<br>
                Bachelor Studiengang, 5. Semester</p>
            </div>
            <div class="info-section">
                <h3>AI Workflow</h3>
                <p>1. <strong>Objekterkennung:</strong> Das hochgeladene Bild wird mit <strong>Google Gemini 2.0 Flash</strong> analysiert, um das Hauptobjekt zu identifizieren.</p>
                <p>2. <strong>Geocoding:</strong> GPS-Daten (EXIF) aus dem Bild werden extrahiert und mit <strong>Google Geocoding API</strong> das entsprechende Basler Quartier ermittelt.</p>
                <p>3. <strong>Bildgenerierung:</strong> Mit <strong>Flux Pro 1.1</strong> (via fal.ai) werden stilisierte Illustrationen generiert. Die Stilisierung basiert auf Zeichnungen von Oliver Wick und wurde durch LoRA-Training in das Modell integriert.</p>
            </div>
            <div class="info-section info-disclaimer">
                <h3>Datenschutz</h3>
                <p>Ihre hochgeladenen Bilder werden <strong>nicht auf unserem Server gespeichert</strong>. Die Bilder werden nur temporär verarbeitet und zur Analyse an externe AI-Dienste (Google Gemini, Flux Pro via fal.ai) weitergeleitet.</p>
                <p><strong>Hinweis:</strong> Wir haben keine Kontrolle darüber, wie diese Drittanbieter Ihre Daten verarbeiten. Bitte laden Sie keine sensiblen oder persönlichen Bilder hoch.</p>
            </div>
        </div>
    </div>

    <script src="handtracking.js"></script>
    <script src="app.js"></script>
</body>
</html>

